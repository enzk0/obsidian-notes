```
for payment in tellering:
                non_ledge = 0
                itx = ""
                is_non_ledger = 0
                back_account_items = []
                grouped_items = {}

  
                items = frappe.db.sql("""
                    SELECT it.item_group, per.item_name, per.allocated_amount
                    FROM `tabPayment Entry Reference V2` AS per
                    LEFT JOIN `tabItem` AS it ON it.name = per.item_name
                    WHERE per.parent = %s
                """, (payment[4],), as_dict=1)
  

                for item in items:
                    check_group = item.item_group.upper()
                    amt = item.allocated_amount
  

                    if check_group == "BACK ACCOUNT":
                        back_account_items.append(item)
                    else:
                        grouped_items[check_group] = grouped_items.get(check_group, 0) + amt
  

                descriptions = list(grouped_items.keys())
                if back_account_items:
                    descriptions.append("BACK ACCOUNT")
                # balance = balance
                # if is_non_ledger != 1:

                total_ = payment[0]
  

                if total_:
  

                    balance = balance - round(abs(payment[0]), 2)
                    total_payments += round(abs(payment[0]), 2)
                    gl_entries.append({
                        "date": payment[1],
                        "student": student,
                        "course": course,
                        "or_no": payment[3],
                        "description": ", ".join(descriptions),
                        "debit": "",
                        "credit": float(round(payment[0], 2)),
                        "balance": float(round(balance, 2)),
                        "address": add_,
                        "year": yrlevel,
                    "customer_tag": student,
                        "student_name": fname,
                        "item_tag":"payment",
  
  

                    })

                    for item in back_account_items:
                        gl_entries.append({
                            "date": "",
                            "student": student,
                            "course": course,
                            "or_no": payment[3],
                            "description": (item.item_name or item.item_group or "").upper(),
                            "debit": "",
                            "credit": float(round(item.allocated_amount or 0, 2)),
                            "balance": float(round(balance, 2)),
                            "address": add_,
                            "year": yrlevel,
                            "customer_tag": student,
                            "student_name": fname,
                            "item_tag": "payment_item",

                        })

                    if grouped_items:
                        for group, amt in grouped_items.items():
                            gl_entries.append({
                                "date": "",
                                "student": student,
                                "course": course,
                                "or_no": payment[3],
                                "description": group.upper(),
                                "debit": "",
                                "credit": float(round(amt, 2)),
                                "balance": float(round(balance, 2)),
                                "address": add_,
                                "year": yrlevel,
                                "customer_tag": student,
                                "student_name": fname,
                                "item_tag": "payment_item",

                            })
```