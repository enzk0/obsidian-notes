
- for ***COM***:
```
<script>
    var dt = new Date();
    document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
</script>
<div>
    <div>
<!--        HEADER-->
        <table border="0" width="100%">
            <tr>

                <td width="13%">
                        <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
                </td>
                <td width="65%" align="center">
                    <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                    <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                    <p>{{doc.semester}} - {{doc.school_year}}</p>
                    <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
                </td>
                <td width="15%">
                </td>
            </tr>
        </table>
<!--        STUDENT INFO-->
        <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
        <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
        <div ><b>Year Level: <u>{{doc.year_level}}</u></b></div>
        <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div>
<!--CHARGES AND OBLIGATION-->
        <table border="0" width=100% style="margin-top: -10px">
            <tr>
<!--CHARGES ONLY-->
    {% set ceap_fee = [] -%}
    {% set registration_fee = [] -%}
    {% set tuition_fee = [] -%}
    {% set miscellaneous_fee = [] -%}
    {% set criminalistic_fee = [] -%}
    {% set human_kinetics_fee = [] -%}
    {% set forensic_fee = [] -%}
    {% set laboratory_fee = [] -%}
    {% set lab_dev = [] -%}
    {% set identification_card = [] -%}
    {% set internship_fee = [] -%}

    {%- for rows in doc.tuition_table -%}
        {% set item_group = frappe.get_doc("Item",rows.subject).item_group %}
<!--                CEAP-->
        {%- if 'CEAP' in rows.subject_bill  %}
                {% if ceap_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
                {% if ceap_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                REGISTRATION FEE-->
        {%- if 'Registration' in rows.subject_bill %}
            {% if registration_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if registration_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                TUITION FEE-->
        {%- if 'Subject' in rows.subject_bill%}
            {% if tuition_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
             {% if tuition_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                Miscellaneous-->
        {%- if 'miscellaneous' in item_group.lower() -%}
            {% if miscellaneous_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if miscellaneous_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                HUMAN KINETICS FEE-->
        {%- if 'human' in item_group.lower() -%}
            {% if human_kinetics_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if human_kinetics_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                FORENSIC FEE-->
        {%- if 'forensic' in item_group.lower() -%}
            {% if forensic_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if forensic_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                CRIMINALISTIC FEE-->
        {%- if 'criminalistic' in item_group.lower() -%}
            {% if criminalistic_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if criminalistic_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                LABORATORY FEE-->
        {%- if 'laboratory' in item_group.lower() -%}
            {% if laboratory_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if laboratory_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                Lab Dev-->
        {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
            {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
<!--                Identification-->
        {%- if 'Identification' in rows.subject_bill %}
            {% if identification_card.append({"amounts":rows.amount|float}) %}{% endif %}
        {% else %}
            {% if identification_card.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                INTERNSHIP-->
        {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
            {% if internship_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if internship_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
    {% endfor %}
<!--                ADDITIONAL TABLE-->
    {% set labs_addi = [] -%}
    {% set old_balance = [] -%}
    {% set special_class = [] -%}
    {% set excess_fee = [] -%}
    {%- for rows in doc.additional_table -%}
        {%- if 'Lab' in rows.item_name %}
            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
            {% else %}
                {% if rows.amount %}
                    {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% else %}
                    {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                {% endif %}
            {% endif %}
        {% endif %}

        {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% endif %}
        {% endif %}

        {%- if 'Identification' in rows.item_name %}
            {% if identification_card.append({"amounts":rows.amount|float}) %}{% endif %}
        {% else %}
            {% if identification_card.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if 'Previous Balance' in rows.item_name or 'OLD BALANCE' in rows.item_name or 'Old Balance' in rows.item_name %}
            {%- if rows.amount|float > 0|float %}
                {% if old_balance.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% endif %}
        {% endif %}

        {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
            {% if internship_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if internship_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
            {% if special_class.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if special_class.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if rows.item_name == 'Previous Balance' %}
            {%- if rows.amount|float < 0|float %}
                {% if excess_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% endif %}
        {% endif %}
    {% endfor %}
                <td width="50%">
                    <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                        <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">{{frappe.utils.fmt_money(ceap_fee|sum(attribute= 'amounts')|round(2), precision=2)}} </p>
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>

                        <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(registration_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                    </div>
                    <div style="display: flex; width: 100%" >
                     <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                        {%- if doc.tuition_discount %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p>

                        {%- elif doc.tuition_discount_percent %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') - (tuition_fee|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)))}}</p>

                       {%- else %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') |round(2), precision=2)}}</p>
                        {% endif %}
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(miscellaneous_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>
                       <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(laboratory_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                {% set criminalistic = criminalistic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                {% set forensic = forensic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                {% set human = human_kinetics_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                {% if "BSCRIM".upper() in doc.course.upper() %}
                    {% if criminalistic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Criminalistic Fee </p>
                    <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(criminalistic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if forensic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Forensic Fee </p>
                    <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(forensic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if human != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Human Kinetics Fee </p>
                    <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(human, precision=2)}}</p>
                    </div>
                    {% endif %}
                {% endif %}
                {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                    <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Fee</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(identification_card|sum(attribute= 'amounts')|round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Old Balance</p>
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(old_balance|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                        {% if internship_fee|len > 0 %}
                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(internship_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                       {% else %}
                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(internship_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                        {% endif %}
                    </div>
                    <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(special_class|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Excess Payment Less</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(excess_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment| round(2), precision=2) }}</p>
                    </div>
                    <br>
                </td>

<!--                OBLIGATION-->
    {% set upon = [] -%}
    {% set prelim = [] -%}
    {% set midterm = [] -%}
    {% set semi = [] -%}
    {% set finals = [] -%}
    {%- for rows in doc.table_22 -%}
        {%- if 'Upon Enrollment' in rows.exam %}
            {% if upon.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Prelim' in rows.exam %}
            {% if prelim.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Midterm' in rows.exam %}
            {% if midterm.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Semi' in rows.exam %}
            {% if semi.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Finals' in rows.exam %}
            {% if finals.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
   {% endfor %}
                <td width="50%">
                    <p><center><b>OBLIGATION</b></center></p>
                    {%- for rows in doc.table_22 -%}
                        <div style="; display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">{{rows.exam}}</p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                       </div>
                    {% endfor %}
                    <br>
                    <br>
                    <div style="display: flex; width: 100%">
                       <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                       <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment| round(2), precision=2)}}</p>
                   </div>
                </td>
            </tr>
        </table>
        <table border="0" width="100%" style="margin-top: -25px">
            <tr>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>
            </tr>

             {%- for row in doc.subjects -%}
                <tr>
                    <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
                    <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
                    <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
                    <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
                    <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
                    <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
                    <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>
                </tr>
            {% endfor %}
        </table>
        <div style="width: 100%; display: flex">
            <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length}}</b></p>
            <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units}}</b></p>
        </div>
        <div style="width: 100%">
            <p style="text-align: right; margin-top: 4px;"><u><b>________________________</b></u></p>
            <p style="text-align: right; margin-bottom: 4px; margin-right: 20px">Student Signature</p>
        </div>
<p> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</p>
    <!--        HEADER-->
        <table border="0" width="100%">
            <tr>

                <td width="13%">
                        <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
                </td>
                <td width="65%" align="center">
                    <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                    <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                    <p>{{doc.semester}} - {{doc.school_year}}</p>
                    <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
                </td>
                <td width="15%">
                </td>
            </tr>
        </table>
<!--        STUDENT INFO-->
        <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
        <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
        <div ><b>Year Level: <u>{{doc.year_level}}</u></b></div>
        <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div>
<!--CHARGES AND OBLIGATION-->
        <table border="0" width=100% style="margin-top: -10px">
            <tr>
<!--CHARGES ONLY-->
    {% set ceap_fee = [] -%}
    {% set registration_fee = [] -%}
    {% set tuition_fee = [] -%}
    {% set miscellaneous_fee = [] -%}
    {% set criminalistic_fee = [] -%}
    {% set human_kinetics_fee = [] -%}
    {% set forensic_fee = [] -%}
    {% set laboratory_fee = [] -%}
    {% set lab_dev = [] -%}
    {% set identification_card = [] -%}
    {% set internship_fee = [] -%}

    {%- for rows in doc.tuition_table -%}
        {% set item_group = frappe.get_doc("Item",rows.subject).item_group %}
<!--                CEAP-->
        {%- if 'CEAP' in rows.subject_bill  %}
                {% if ceap_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
                {% if ceap_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                REGISTRATION FEE-->
        {%- if 'Registration' in rows.subject_bill %}
            {% if registration_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if registration_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                TUITION FEE-->
        {%- if 'Subject' in rows.subject_bill%}
            {% if tuition_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
             {% if tuition_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                Miscellaneous-->
        {%- if 'miscellaneous' in item_group.lower() -%}
            {% if miscellaneous_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if miscellaneous_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                HUMAN KINETICS FEE-->
        {%- if 'human' in item_group.lower() -%}
            {% if human_kinetics_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if human_kinetics_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                FORENSIC FEE-->
        {%- if 'forensic' in item_group.lower() -%}
            {% if forensic_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if forensic_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                CRIMINALISTIC FEE-->
        {%- if 'criminalistic' in item_group.lower() -%}
            {% if criminalistic_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if criminalistic_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                LABORATORY FEE-->
        {%- if 'laboratory' in item_group.lower() -%}
            {% if laboratory_fee.append({'amounts': rows.amount}) -%}{% endif %}
        {% else %}
            {% if laboratory_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                Lab Dev-->
        {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
            {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
<!--                Identification-->
        {%- if 'Identification' in rows.subject_bill %}
            {% if identification_card.append({"amounts":rows.amount|float}) %}{% endif %}
        {% else %}
            {% if identification_card.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
<!--                INTERNSHIP-->
        {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
            {% if internship_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if internship_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}
    {% endfor %}
<!--                ADDITIONAL TABLE-->
    {% set labs_addi = [] -%}
    {% set old_balance = [] -%}
    {% set special_class = [] -%}
    {% set excess_fee = [] -%}
    {%- for rows in doc.additional_table -%}
        {%- if 'Lab' in rows.item_name %}
            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
            {% else %}
                {% if rows.amount %}
                    {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% else %}
                    {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                {% endif %}
            {% endif %}
        {% endif %}

        {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% endif %}
        {% endif %}

        {%- if 'Identification' in rows.item_name %}
            {% if identification_card.append({"amounts":rows.amount|float}) %}{% endif %}
        {% else %}
            {% if identification_card.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if 'Previous Balance' in rows.item_name or 'OLD BALANCE' in rows.item_name or 'Old Balance' in rows.item_name %}
            {%- if rows.amount|float > 0|float %}
                {% if old_balance.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% endif %}
        {% endif %}

        {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
            {% if internship_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if internship_fee.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
            {% if special_class.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
        {% else %}
            {% if special_class.append({'amounts': 0}) -%}{% endif %}
        {% endif %}

        {%- if rows.item_name == 'Previous Balance' %}
            {%- if rows.amount|float < 0|float %}
                {% if excess_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% endif %}
        {% endif %}
    {% endfor %}
                <td width="50%">
                    <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                        <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">{{frappe.utils.fmt_money(ceap_fee|sum(attribute= 'amounts')|round(2), precision=2)}} </p>
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>

                        <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(registration_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                    </div>
                    <div style="display: flex; width: 100%" >
                     <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                        {%- if doc.tuition_discount %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p>

                        {%- elif doc.tuition_discount_percent %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') - (tuition_fee|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)))}}</p>

                       {%- else %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(tuition_fee|sum(attribute= 'amounts') |round(2), precision=2)}}</p>
                        {% endif %}
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(miscellaneous_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>
                       <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(laboratory_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% set criminalistic = criminalistic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                    {% set forensic = forensic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                    {% set human = human_kinetics_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
                    {% if "BSCRIM".upper() in doc.course.upper() %}
                        {% if criminalistic != 0 %}
                        <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Criminalistic Fee </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(criminalistic, precision=2)}}</p>
                        </div>
                        {% endif %}
                        {% if forensic !=0 %}
                        <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Forensic Fee </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(forensic, precision=2)}}</p>
                        </div>
                        {% endif %}
                        {% if human !=0 %}
                        <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Human Kinetics Fee </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(human, precision=2)}}</p>
                        </div>
                        {% endif %}
                    {% endif %}
                    {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                         <div style="display: flex; width: 100%" >
                             <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                             <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                        </div>
                    {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Fee</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(identification_card|sum(attribute= 'amounts')|round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Old Balance</p>
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(old_balance|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                        {% if internship_fee|len > 0 %}
                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(internship_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                       {% else %}
                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(internship_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                        {% endif %}
                    </div>
                    <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(special_class|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Excess Payment Less</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(excess_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment| round(2), precision=2) }}</p>
                    </div>
                    <br>
                </td>

<!--                OBLIGATION-->
    {% set upon = [] -%}
    {% set prelim = [] -%}
    {% set midterm = [] -%}
    {% set semi = [] -%}
    {% set finals = [] -%}
    {%- for rows in doc.table_22 -%}
        {%- if 'Upon Enrollment' in rows.exam %}
            {% if upon.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Prelim' in rows.exam %}
            {% if prelim.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Midterm' in rows.exam %}
            {% if midterm.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Semi' in rows.exam %}
            {% if semi.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
        {%- if 'Finals' in rows.exam %}
            {% if finals.append({'amounts': rows.amount}) -%}{% endif %}
        {% endif %}
   {% endfor %}
                <td width="50%">
                    <p><center><b>OBLIGATION</b></center></p>
                    {%- for rows in doc.table_22 -%}
                        <div style="; display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">{{rows.exam}}</p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                       </div>
                    {% endfor %}
                    <br>
                    <br>
                    <div style="display: flex; width: 100%">
                       <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                       <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment| round(2), precision=2)}}</p>
                   </div>
                </td>
            </tr>
        </table>
        <table border="0" width="100%" style="margin-top: -25px">
            <tr>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
                <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>
            </tr>

             {%- for row in doc.subjects -%}
                <tr>
                    <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
                    <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
                    <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
                    <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
                    <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
                    <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
                    <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>
                </tr>
            {% endfor %}
        </table>
        <div style="width: 100%; display: flex">
            <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length}}</b></p>
            <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units}}</b></p>
        </div>
        <div style="width: 100%">
            <p style="text-align: right; margin-right:150px; margin-top:4px"><b>Checked by:</b></p>
            <p style="text-align: right; margin-top: 3px"><u><b>{{ frappe.db.get_value("School WC", "School WC", "accounting_head") }}</b></u></p>
            <p style="text-align: right; margin-right: 15px">Head Accounting Office</p>
        </div>
    </div>
</div>
```
Code Result from COM v2:
![[Pasted image 20250916155345.png]]


- for ***TES Matriculation with Balance***
```
<script>
    var dt = new Date();
    document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
    </script>
    <div>
    <div >
    <table border="0" width="100%">
            <tr>

                <td width="13%">
                        <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
                </td>
                <td width="65%" align="center">
                    <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                    <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                    <p>{{doc.semester}} - {{doc.school_year}}</p><br>
                    <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5><br>
                </td>
                <td width="15%">
                </td>
            </tr>
        </table>

            <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
            <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
            <div ><b>Year Level: <u>{{doc.year_level}}</u></b></div>
            <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div><br><br>
    {% set totals = [] -%}
        <table border="0" width=100% style="margin-top: -10px">

<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
                <td width="50%">

                    <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                     <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                         {% set at = [] -%}
                         
                        {%- for rows in doc.tuition_table -%}
                        
                            {%- if 'CEAP' in rows.subject_bill  %}
                                    {% if at.append({'amounts': rows.amount|float}) -%}{% endif %}
                                    {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% else %}
                                    {% if at.append({'amounts': 0}) -%}{% endif %}
                            {% endif %}
                      {% endfor %}
                        <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>

                    </div>

                    <div style="display: flex; width: 100%" >


                    <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>
                        {% set amounting = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Registration' in rows.subject_bill %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                        {% endif %}
                          {% endfor %}
                    </div>
                    <div style="display: flex; width: 100%" >
                        {% set amounting = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Subject' in rows.subject_bill%}
                            {% if amounting.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% else %}
                             {% if amounting.append({'amounts': 0}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}
                     <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                        {%- if doc.tuition_discount %}
                     <!-- <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p> -->
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>

                        {%- elif doc.tuition_discount_percent %}
                     <!-- <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - (amounting|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)) |round(2), precision=2)}}</p> -->
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>

                       {%- else %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>



                        {% endif %}
                    </div>

                    {% set misc = [] -%}
                    {% set misc_ath = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if  'Medical/Dental' in rows.subject_bill
                                or 'Cultural' in rows.subject_bill
                                or 'Guidance' in rows.subject_bill
                                or 'Student' in rows.subject_bill
                                or 'Energy' in rows.subject_bill
                                or 'Research &' in rows.subject_bill
                                or 'Faculty' in rows.subject_bill
                                or 'Electronic' in rows.subject_bill
                                or 'Library' in rows.subject_bill
                                or 'Internet' in rows.subject_bill
                                or 'Publication' in rows.subject_bill
                                or 'Athletic' in rows.subject_bill
                                or 'Insurance' in rows.subject_bill
                        %}
                          {% if 'CEAP' in rows.subject_bill %}

                          {% else %}
                                {% if misc.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                          {% endif %}


                        {% else %}
                             {% if misc.append({'amounts': 0}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>



                    {% set labs = [] -%}
                        {%- for rows in doc.tuition_table -%}
                            {% if 'Subject:' in rows.subject_bill %}
                            {% set lab_def = frappe.get_list("Lab Fees Setup Child", filters={"subject" :rows.subject, "course": doc.course}, fields=("amount")) %}
                            {% for tt in lab_def %}
                                {% if tt.amount %}
                                    {% if labs.append({'amounts': tt.amount}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                {% else %}
                                    {% if labs.append({'amounts': 0}) -%}{% endif %}
                                {% endif %}

                            {% endfor %}
                                                    {% endif %}


                                {%- if 'Lab' in rows.subject_bill 
                    or 'lab' in rows.subject_bill %}
                                    {% if 'dev' in rows.subject_bill or 'Dev' in rows.subject_bill %}
                                    {% else %}
                                        {% if rows.amount %}
                                            {% if labs.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                        {% else %}
                                            {% if labs.append({'amounts': 0}) -%}{% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                      {% endfor %}

                    {% set labs_addi = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'Lab' in rows.item_name %}
                                    {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                                {% else %}
                                    {% if rows.amount %}
                                        {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                    {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                    {% else %}
                                        {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                                    {% endif %}
                                {% endif %}
                        {% endif %}
                      {% endfor %}
                      <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>

                                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(labs|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    {% set lab_dev = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
                            {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                    {%- for rows in doc.additional_table -%}
                        {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                            {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                        {% endif %}
                      {% endfor %}
                      {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                     <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Fee</p>
                       {% set amounting = [] -%}
                       {% set identification_card = {"amount":0} -%}
                           {%- for rows in doc.additional_table -%}
                               {%- if 'Identification' in rows.item_name %}
                                   {% if identification_card.update({"amount":rows.amount}) %}{% endif %}
                                   {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                               {% endif %}
                           {% endfor %}
                           {%- for rows in doc.tuition_table -%}
                               {%- if 'Identification' in rows.subject_bill %}
                                   {% if identification_card.update({"amount":rows.amount}) %}{% endif %}
                                   {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                               {% endif %}
                           {% endfor %}
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(identification_card['amount']|float|round(2), precision=2)}}</p>
                       </div>

                      {% set intern = [] -%}
                      {% set interns = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                        {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                     {%- for rows in doc.tuition_table -%}
                        {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                  <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                            {% if inter|len > 0 %}
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                      {% else %}
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                            {% endif %}
                        </div>

                       

{% set intern = [] -%}
{% set interns = [] -%}
{%- for rows in doc.additional_table -%}
    {%- if 'CRIMINALISTIC FEE' in rows.item_name or 'Criminalistic Fee' in rows.item_name or 'criminalistic fee' in rows.item_name  %}
        {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
    {% endif %}
{% endfor %}

{%- for rows in doc.tuition_table -%}
    {%- if 'CRIMINALISTIC FEE' in rows.subject_bill or 'Criminalistic Fee' in rows.subject_bill or 'criminalistic Fee' in rows.subject_bill  %}
        {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
            {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
    {% endif %}
{% endfor %}

{% if interns|sum(attribute= 'amounts')| round(2) > 0 %}
<div style="display: flex; width: 100%;" >
<p style="width: 60%; margin-top: -2px; font-size: 10px">Criminalistic Fee</p>
    {% if inter|len > 0 %}
<p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
{% else %}  
<p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

    {% endif %}
</div>
{% endif %}
                          {% set intern = [] -%}
                          {% set interns = [] -%}
                            {%- for rows in doc.additional_table -%}
                            {%- if 'FORENSIC FEE' in rows.item_name or 'Forensic Fee' in rows.item_name or 'forensic fee' in rows.item_name  %}
                            {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                         {%- for rows in doc.tuition_table -%}
                            {%- if 'FORENSIC FEE' in rows.subject_bill or 'Forensic Fee' in rows.subject_bill or 'forensic fee' in rows.subject_bill  %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
                    
                          {% if interns|sum(attribute= 'amounts')| round(2) > 0 %}
                      <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Forensic Fee</p>
                                {% if inter|len > 0 %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                          {% else %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                                {% endif %}
                            </div>
                            {% endif %}

                            {% set intern = [] -%}
                          {% set interns = [] -%}
                            {%- for rows in doc.additional_table -%}
                            {%- if 'HUMAN KINETICS' in rows.item_name or 'Human Kinetics' in rows.item_name or 'human kinetics' in rows.item_name  %}
                            {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                         {%- for rows in doc.tuition_table -%}
                            {%- if 'HUMAN KINETICS' in rows.subject_bill or 'Human Kinetics' in rows.subject_bill or 'human kinetics' in rows.subject_bill  %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
                       
                        {% if interns|sum(attribute= 'amounts')| round(2) > 0 %}
                      <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Human Kinetics Fee</p>
                                {% if inter|len > 0 %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                          {% else %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
    
                                {% endif %}
                            </div>
                            {% endif %}

  {% set book = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if rows.item_name == 'BOOK'
                                or 'BOOKS' in rows.item_name
                                or 'book' in rows.item_name
                                or 'books' in rows.item_name
                        %}
                        {% if rows.amount %}
                                        {% if book.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                    {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                    {% else %}
                                        {% if book.append({'amounts': 0|float}) -%}{% endif %}
                                    {% endif %}
                        {% endif %}
                      {% endfor %}

{%set addfee= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts')) %}
{%set dividefive= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts'))/5 %}
                   <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p>
                    {% set special = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount|float)}}</p>
                        {% endif %}
                          {% endfor %}
                    </div>
                
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                    <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')|round(2), precision=2) }}</p>
                    </div>
                    <br>

                </td>

<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; END &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->

            <td width="50%">
                       <p><center><b>OBLIGATION</b></center></p>
                           {% if "Summer" in doc.semester %}
                           {% set upon = [] -%}

                            {%- for rows in doc.table_22 -%}
                                 {%- if 'Upon Enrollment' in rows.exam %}
                                {% if upon.append({'amounts': rows.amount|float}) -%}
                            {% endif %}
                            {% endif %}

                              {% endfor %}

                           <div style=" display: flex; width: 100%">
                               <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                           </div>
                           {% set prelim = [] -%}
                           {% set mid = [] -%}
                            {%- for rows in doc.table_22 -%}
                           {%- if 'Midterm' in rows.exam %}
                                {% if mid.append({'amounts': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                            {% endfor %}

                           <div style="display: flex; width: 100%">
                              <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                              <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                          </div>


                           {% set final = [] -%}

                            {%- for rows in doc.table_22 -%}

                           {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                                {% if final.append({'amounts': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                              {% endfor %}
                           <div style="display: flex; width: 100%">
                               <p style="width: 60%; margin-top: -2px; font-size: 10px">Final</p>
                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                           </div>

                       {% else %}

                       {% set upon = [] -%}
                        {%- for rows in doc.table_22 -%}
                             {%- if 'Upon Enrollment' in rows.exam %}
                            {% if upon.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}

                       <div style=" display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>

                       {% set prelim = [] -%}
                       {% set mid = [] -%}
                        {%- for rows in doc.table_22 -%}
                       {%- if 'Midterm' in rows.exam %}
                            {% if mid.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                       {%- if 'Prelim' in rows.exam %}
                            {% if prelim.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}

                        <div style="display: flex; width: 100%">
                          <p style="width: 60%; margin-top: -2px; font-size: 10px">Preliminary Examination </p>
                          <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>

                      </div>
                       <div style="display: flex; width: 100%">
                          <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                          <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>

                      </div>


                       {% set final = [] -%}
                       {% set semi = [] -%}
                        {%- for rows in doc.table_22 -%}
                       {%- if rows.exam == 'Semi-Final' or rows.exam == 'Semi-Finals' %}
                            {% if semi.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}

                       {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                            {% if final.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}
                        <div style="display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">Semi - Final </p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>
                       <div style="display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -6px">Final</p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>
                {% endif %}
                        <br>
                       {% set totaling = [] -%}
                        {%- for rows in doc.table_22 -%}
                            {% if totaling.append({'amounts': rows.amount|float}) -%}{% endif %}
                          {% endfor %}
                       <br>
<div style="display: flex; width: 100%">
                           <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                           <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')| round(2), precision=2) }}</p>
                       </div>
                </td>


            </table>

<br><br>
        <table border="0" width="100%" style="margin-top: -25px">
            <tr>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>

            </tr>
            {% set deduction_subject = {"len_sub":0,"unit":0} %}
            {%- for row in doc.subjects -%}
            {% if "MS 41" in frappe.db.get_value("Subject WC",row.subject,"course_no") %}
                {% if deduction_subject.update({"len_sub":1,"unit":row.units}) %}{% endif %}
            {% else %}
            <tr>
                <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
                <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
                  <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
                <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
                <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
                <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
                <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>
  
              </tr>
            {% endif %}

            {% endfor %}

        </table>

            <div style="width: 100%; display: flex">
                <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length - deduction_subject.len_sub}}</b></p>
                <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units|float - deduction_subject.unit|float}}</b></p>
            </div><br><br>
        <div style="width: 100%">
            <p style="text-align: right; margin-right:150px; margin-top:4px"><b>Checked by:</b></p><br>
            <p style="text-align: right; margin-top: 3px"><u><b>{{ frappe.db.get_value("School WC", "School WC", "accounting_head") }}</b></u></p>
             <p style="text-align: right; margin-right: 15px">Head Accounting Office</p>
        </div>
<div style="width: 100%;float: right;" >
</div></div>

    </div>
        <div >
   
```
Code result from TES Matriculation with Balance v2:
![[Pasted image 20250916155518.png]]

-  for ***TES Matriculation***
```
<script>
    var dt = new Date();
    document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
    </script>
    <div>
    <div >
    <table border="0" width="100%">
            <tr>

                <td width="13%">
                        <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
                </td>
                <td width="65%" align="center">
                    <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                    <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                    <p>{{doc.semester}} - {{doc.school_year}}</p><br>
                    <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5><br>
                </td>
                <td width="15%">
                </td>
            </tr>
        </table>

            <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
            <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
            <div ><b>Year Level: <u>{{doc.year_level}}</u></b></div>
            <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div><br><br>
    {% set totals = [] -%}
        <table border="0" width=100% style="margin-top: -10px">

<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->
                <td width="50%">

                    <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                     <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                         {% set at = [] -%}
                        {%- for rows in doc.tuition_table -%}
                            {%- if 'CEAP' in rows.subject_bill  %}
                                    {% if at.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% else %}
                                    {% if at.append({'amounts': 0}) -%}{% endif %}
                            {% endif %}
                      {% endfor %}
                        <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>

                    </div>

                    <div style="display: flex; width: 100%" >


                    <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>
                        {% set amounting = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Registration' in rows.subject_bill %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                        {% endif %}
                          {% endfor %}
                    </div>
                    <div style="display: flex; width: 100%" >
                        {% set amounting = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Subject' in rows.subject_bill%}
                            {% if amounting.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% else %}
                             {% if amounting.append({'amounts': 0}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}
                     <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                        {%- if doc.tuition_discount %}
                     <!-- <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p> -->
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>

                        {%- elif doc.tuition_discount_percent %}
                     <!-- <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - (amounting|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)) |round(2), precision=2)}}</p> -->
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>

                       {%- else %}
                     <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>



                        {% endif %}
                    </div>

                    {% set misc = [] -%}
                    {% set misc_ath = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if  'Medical/Dental' in rows.subject_bill
                                or 'Cultural' in rows.subject_bill
                                or 'Guidance' in rows.subject_bill
                                or 'Student' in rows.subject_bill
                                or 'Energy' in rows.subject_bill
                                or 'Research &' in rows.subject_bill
                                or 'Faculty' in rows.subject_bill
                                or 'Electronic' in rows.subject_bill
                                or 'Library' in rows.subject_bill
                                or 'Internet' in rows.subject_bill
                                or 'Publication' in rows.subject_bill
                                or 'Athletic' in rows.subject_bill
                                or 'Insurance' in rows.subject_bill
                        %}
                          {% if 'CEAP' in rows.subject_bill %}

                          {% else %}
                                {% if misc.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                          {% endif %}


                        {% else %}
                             {% if misc.append({'amounts': 0}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                                            <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>



                    {% set labs = [] -%}
                        {%- for rows in doc.tuition_table -%}
                            {% if 'Subject:' in rows.subject_bill %}
                            {% set lab_def = frappe.get_list("Lab Fees Setup Child", filters={"subject" :rows.subject, "course": doc.course}, fields=("amount")) %}
                            {% for tt in lab_def %}
                                {% if tt.amount %}
                                    {% if labs.append({'amounts': tt.amount}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                {% else %}
                                    {% if labs.append({'amounts': 0}) -%}{% endif %}
                                {% endif %}

                            {% endfor %}
                                                    {% endif %}


                                {%- if 'Lab' in rows.subject_bill 
                    or 'lab' in rows.subject_bill %}
                                    {% if 'dev' in rows.subject_bill or 'Dev' in rows.subject_bill %}
                                    {% else %}
                                        {% if rows.amount %}
                                            {% if labs.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                        {% else %}
                                            {% if labs.append({'amounts': 0}) -%}{% endif %}
                                        {% endif %}
                                    {% endif %}
                                {% endif %}
                      {% endfor %}

                    {% set labs_addi = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'Lab' in rows.item_name %}
                                    {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                                {% else %}
                                    {% if rows.amount %}
                                        {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                    {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                    {% else %}
                                        {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                                    {% endif %}
                                {% endif %}
                        {% endif %}
                      {% endfor %}
                      <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>

                                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(labs|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    {% set lab_dev = [] -%}
                        {%- for rows in doc.tuition_table -%}
                        {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
                            {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                    {%- for rows in doc.additional_table -%}
                        {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                            {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                            {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                        {% endif %}
                      {% endfor %}
                      {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                     <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Fee</p>
                       {% set amounting = [] -%}
                       {% set identification_card = {"amount":0} -%}
                           {%- for rows in doc.additional_table -%}
                               {%- if 'Identification' in rows.item_name %}
                                   {% if identification_card.update({"amount":rows.amount}) %}{% endif %}
                                   {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                               {% endif %}
                           {% endfor %}
                           {%- for rows in doc.tuition_table -%}
                               {%- if 'Identification' in rows.subject_bill %}
                                   {% if identification_card.update({"amount":rows.amount}) %}{% endif %}
                                   {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                               {% endif %}
                           {% endfor %}
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(identification_card['amount']|float|round(2), precision=2)}}</p>
                       </div>

                      {% set intern = [] -%}
                      {% set interns = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                        {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                     {%- for rows in doc.tuition_table -%}
                        {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                        {% endif %}
                      {% endfor %}

                  <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                            {% if inter|len > 0 %}
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                      {% else %}
                     <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                            {% endif %}
                        </div>

                        {% set intern = [] -%}
                        {% set interns = [] -%}
                          {%- for rows in doc.additional_table -%}
                          {%- if 'CRIMINALISTIC FEE' in rows.item_name or 'Criminalistic Fee' in rows.item_name or 'criminalistic fee' in rows.item_name  %}
                          {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
              {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                          {% endif %}
                        {% endfor %}
  
                       {%- for rows in doc.tuition_table -%}
                          {%- if 'CRIMINALISTIC FEE' in rows.subject_bill or 'Criminalistic Fee' in rows.subject_bill or 'criminalistic Fee' in rows.subject_bill  %}
              {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                          {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                          {% endif %}
                        {% endfor %}
  
                    <div style="display: flex; width: 100%;" >
                       <p style="width: 60%; margin-top: -2px; font-size: 10px">Criminalistic Fee</p>
                              {% if inter|len > 0 %}
                       <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                        {% else %}
                       <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
  
                              {% endif %}
                          </div>

                          {% set intern = [] -%}
                          {% set interns = [] -%}
                            {%- for rows in doc.additional_table -%}
                            {%- if 'FORENSIC FEE' in rows.item_name or 'Forensic Fee' in rows.item_name or 'forensic fee' in rows.item_name  %}
                            {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                         {%- for rows in doc.tuition_table -%}
                            {%- if 'FORENSIC FEE' in rows.subject_bill or 'Forensic Fee' in rows.subject_bill or 'forensic fee' in rows.subject_bill  %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                      <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Forensic Fee</p>
                                {% if inter|len > 0 %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                          {% else %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
    
                                {% endif %}
                            </div>

                            {% set intern = [] -%}
                          {% set interns = [] -%}
                            {%- for rows in doc.additional_table -%}
                            {%- if 'HUMAN KINETICS' in rows.item_name or 'Human Kinetics' in rows.item_name or 'human kinetics' in rows.item_name  %}
                            {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                         {%- for rows in doc.tuition_table -%}
                            {%- if 'HUMAN KINETICS' in rows.subject_bill or 'Human Kinetics' in rows.subject_bill or 'human kinetics' in rows.subject_bill  %}
                {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                            {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                            {% endif %}
                          {% endfor %}
    
                      <div style="display: flex; width: 100%;" >
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Human Kinetics Fee</p>
                                {% if inter|len > 0 %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                          {% else %}
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
    
                                {% endif %}
                            </div>


  {% set book = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if rows.item_name == 'BOOK'
                                or 'BOOKS' in rows.item_name
                                or 'book' in rows.item_name
                                or 'books' in rows.item_name
                        %}
                        {% if rows.amount %}
                                        {% if book.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                    {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                                    {% else %}
                                        {% if book.append({'amounts': 0|float}) -%}{% endif %}
                                    {% endif %}
                        {% endif %}
                      {% endfor %}

{%set addfee= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts')) %}
{%set dividefive= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts'))/5 %}
                   <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p>
                    {% set special = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount|float)}}</p>
                        {% endif %}
                          {% endfor %}
                    </div>
                    


                   <div style="display: flex; width: 100%;" >
                     <p style="width: 60%; margin-top: -2px; font-size: 10px">Previous Balance</p>
                    {% set special = [] -%}
                        {%- for rows in doc.additional_table -%}
                        {%- if 'Previous Balance' in rows.item_name or 'PREVIOUS BALANCE' in rows.item_name %}
            {% if totals.append({'total': rows.amount|float}) -%}{% endif %}
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount|float)}}</p>
                        {% endif %}
                          {% endfor %}
                    </div>

           
                    <div style="display: flex; width: 100%" >
                    <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                    <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')| round(2), precision=2) }}</p>
                    </div>
                    <br>

                </td>

<!--&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45; END &#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;-->

            <td width="50%">
                       <p><center><b>OBLIGATION</b></center></p>
                           {% if "Summer" in doc.semester %}
                           {% set upon = [] -%}

                            {%- for rows in doc.table_22 -%}
                                 {%- if 'Upon Enrollment' in rows.exam %}
                                {% if upon.append({'amounts': rows.amount|float}) -%}
                            {% endif %}
                            {% endif %}

                              {% endfor %}

                           <div style=" display: flex; width: 100%">
                               <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                           </div>
                           {% set prelim = [] -%}
                           {% set mid = [] -%}
                            {%- for rows in doc.table_22 -%}
                           {%- if 'Midterm' in rows.exam %}
                                {% if mid.append({'amounts': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                            {% endfor %}

                           <div style="display: flex; width: 100%">
                              <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                              <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                          </div>


                           {% set final = [] -%}

                            {%- for rows in doc.table_22 -%}

                           {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                                {% if final.append({'amounts': rows.amount|float}) -%}{% endif %}
                            {% endif %}
                              {% endfor %}
                           <div style="display: flex; width: 100%">
                               <p style="width: 60%; margin-top: -2px; font-size: 10px">Final</p>
                               <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/3| round(2), precision=2)}}</p>
                           </div>

                       {% else %}

                       {% set upon = [] -%}
                        {%- for rows in doc.table_22 -%}
                             {%- if 'Upon Enrollment' in rows.exam %}
                            {% if upon.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}

                       <div style=" display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>

                       {% set prelim = [] -%}
                       {% set mid = [] -%}
                        {%- for rows in doc.table_22 -%}
                       {%- if 'Midterm' in rows.exam %}
                            {% if mid.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                       {%- if 'Prelim' in rows.exam %}
                            {% if prelim.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}

                        <div style="display: flex; width: 100%">
                          <p style="width: 60%; margin-top: -2px; font-size: 10px">Preliminary Examination </p>
                          <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>

                      </div>
                       <div style="display: flex; width: 100%">
                          <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                          <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>

                      </div>


                       {% set final = [] -%}
                       {% set semi = [] -%}
                        {%- for rows in doc.table_22 -%}
                       {%- if rows.exam == 'Semi-Final' or rows.exam == 'Semi-Finals' %}
                            {% if semi.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}

                       {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                            {% if final.append({'amounts': rows.amount|float}) -%}{% endif %}
                        {% endif %}
                          {% endfor %}
                        <div style="display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -2px; font-size: 10px">Semi - Final </p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>
                       <div style="display: flex; width: 100%">
                           <p style="width: 60%; margin-top: -6px">Final</p>
                           <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')/5| round(2), precision=2)}}</p>
                       </div>
                {% endif %}
                        <br>
                       {% set totaling = [] -%}
                        {%- for rows in doc.table_22 -%}
                            {% if totaling.append({'amounts': rows.amount|float}) -%}{% endif %}
                          {% endfor %}
                       <br>
<div style="display: flex; width: 100%">
                           <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                           <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(totals|sum(attribute= 'total')| round(2), precision=2) }}</p>
                       </div>
                </td>


            </table>

<br><br>
        <table border="0" width="100%" style="margin-top: -25px">
            <tr>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
            <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>

            </tr>
            {% set deduction_subject = {"len_sub":0,"unit":0} %}
            {%- for row in doc.subjects -%}
            {% if "MS 41" in frappe.db.get_value("Subject WC",row.subject,"course_no") %}
                {% if deduction_subject.update({"len_sub":1,"unit":row.units}) %}{% endif %}
            {% else %}
            <tr>
                <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
                <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
                  <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
                <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
                <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
                <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
                <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>
  
              </tr>
            {% endif %}

            {% endfor %}

        </table>

            <div style="width: 100%; display: flex">
                <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length - deduction_subject.len_sub}}</b></p>
                <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units|float - deduction_subject.unit|float}}</b></p>
            </div><br><br>
        <div style="width: 100%">
            <p style="text-align: right; margin-right:150px; margin-top:4px"><b>Checked by:</b></p><br>
            <p style="text-align: right; margin-top: 3px"><u><b>{{ frappe.db.get_value("School WC", "School WC", "accounting_head") }}</b></u></p>
             <p style="text-align: right; margin-right: 15px">Head Accounting Office</p>
        </div>
<div style="width: 100%;float: right;" >
</div></div>

    </div>
        <div >
   
```
Code result from TES Matriculation v2:
![[Pasted image 20250916155608.png]]

-  for ***Scholarship Matriculation***
```
<script>
  var dt = new Date();
  document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
  </script>
  <div>
  <div >
  <table border="0" width="100%">
          <tr>

              <td width="13%">
                      <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
              </td>
              <td width="65%" align="center">
                  <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                  <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                  <p>{{doc.semester}} - {{doc.school_year}}</p>
                  <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
              </td>
              <td width="15%">
              </td>
          </tr>
      </table>

          <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
          <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
          <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div>

      <table border="0" width=100% style="margin-top: -10px">

              <td width="50%">

                  <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                   <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                       {% set at = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'CEAP' in rows.subject  %}
                          {% if at.append({'amounts': rows.amount}) -%}


  {% endif %}
                      {% endif %}
                    {% endfor %}
                      <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">
{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>

                  </div>

                  <div style="display: flex; width: 100%" >


                  <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>
                      {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Registration' in rows.subject_bill %}
                      <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>

                      {% endif %}
                        {% endfor %}
                  </div>
                  <div style="display: flex; width: 100%" >
                      {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Subject' in rows.subject_bill%}
                          {% if amounting.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
                   <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                      {%- if doc.tuition_discount %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p>

                      {%- elif doc.tuition_discount_percent %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - (amounting|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)) |round(2), precision=2)}}</p>

                     {%- else %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>



                      {% endif %}
                  </div>

                  {% set misc = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if rows.subject == 'Athletic'
                              or 'Medical/Dental' in rows.subject
                              or 'Cultural' in rows.subject
                              or 'Guidance' in rows.subject
                              or 'Student' in rows.subject
                              or 'Energy' in rows.subject
                              or 'Research &' in rows.subject
                              or 'Faculty' in rows.subject
                              or 'Electronic' in rows.subject
                              or 'Library' in rows.subject
                              or 'Internet' in rows.subject
                              or 'Publication' in rows.subject
                              or 'Insurance' in rows.subject_bill
                      %}
                          {% if misc.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}

                  <div style="display: flex; width: 100%" >
                 <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                  <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>



                  {% set labs = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {% set lab_def = frappe.get_list("Lab Fees Setup Child", filters={"subject" :rows.subject, "course": doc.course}, fields=("amount")) %}
                          {% for tt in lab_def %}
                              {% if labs.append({'amounts': tt.amount}) -%}{% endif %}
                          {% endfor %}

                      {%- if 'Lab' in rows.subject or 'Human' in rows.subject or 'Forencis Fee' in rows.subject or 'Forensic Fee' in rows.subject %}
                                  {% if 'dev' in rows.subject or 'Dev' in rows.subject %}
                              {% else %}
                                  {% if labs.append({'amounts': rows.amount}) -%}{% endif %}
                              {% endif %}
                      {% endif %}
                    {% endfor %}

                  {% set labs_addi = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Lab' in rows.item_name %}
                                  {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                              {% else %}
                                  {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                              {% endif %}
                      {% endif %}
                    {% endfor %}
                    <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(labs|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>

                  {% set lab_dev = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Lab Dev' in rows.subject or 'Lab dev' in rows.subject  or 'lab dev' in rows.subject %}
                          {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}

                  {%- for rows in doc.additional_table -%}
                      {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                                          {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                          {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                      {% endif %}
                      {% endif %}
                    {% endfor %}
                    {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                   <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>
                  {% endif %}
                  <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Card</p>
                  {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Identification' in rows.subject_bill %}
                      <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                      {% endif %}
                        {% endfor %}
                  </div>

{% set old = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Previous Balance' in rows.item_name or 'OLD BALANCE' in rows.item_name or 'Old Balance' in rows.item_name %}
                                                  {%- if rows.amount|float > 0|float %}

                      {% if old.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}

                      {% endif %}
                      {% endif %}
                    {% endfor %}
<!-- <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Old Balance</p>

                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(old|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
</div> -->
                    {% set intern = [] -%}
                    {% set interns = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                      {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
                   {%- for rows in doc.tuition_table -%}
                      {%- if 'INTERNSHIP' in rows.subject or 'Internship' in rows.subject or 'internship' in rows.subject  %}
                      {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
                <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                          {% if inter|len > 0 %}
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    {% else %}
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                          {% endif %}

                      </div>
{% set book = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if rows.item_name == 'BOOK'
                              or 'BOOKS' in rows.item_name
                              or 'book' in rows.item_name
                              or 'books' in rows.item_name
                      %}
                      {% if book.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
<!-- <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Books Fee</p>

                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(book|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
</div> -->
{%set bookfee=book|sum(attribute= 'amounts')%}
{%set addfee= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts') + old|sum(attribute= 'amounts')) %}
{%set dividefive= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts') + old|sum(attribute= 'amounts'))/5 %}
                 <div style="display: flex; width: 100%;" >
                   <!-- <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p> -->
                  {% set special = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
                      <!-- <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount)}}</p> -->
                      {% endif %}
                        {% endfor %}
                  </div>
                  <div style="display: flex; width: 100%;" >
                   <!-- <p style="width: 60%; margin-top: -2px; font-size: 10px">Excess Payment Less</p> -->
                  {% set amounting = [] -%}
                  {% set excess = [] -%}
<!--                            {%- for rows in doc.tuition_table -%}-->
<!--                            {%- if 'Excess' in rows.subject %}-->
<!--                            <p style="width: 40%; margin-top: -2px; text-align: right; margin-left: -20px; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>-->
<!--                            {% endif %}-->
<!--                              {% endfor %}-->

                      {%- for rows in doc.additional_table -%}
                      {%- if rows.item_name == 'Previous Balance' %}
                          {%- if rows.amount|float < 0|float %}
                          {% if excess.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                              <!-- <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(excess|sum(attribute= 'amounts')| round(2), precision=2)}}</p> -->

                          {% endif %}
                      {% endif %}
                    {% endfor %}
                  </div>
                  <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                  {% set finalamount = doc.final_assessment - bookfee %}
                  <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(finalamount | round(2), precision=2)}}</p>
                  </div>
                  <br>

              </td>

                 <td width="50%">
                     <p><center><b>OBLIGATION</b></center></p>

                     {% set upon = [] -%}
                      {%- for rows in doc.table_22 -%}
                           {%- if 'Upon Enrollment' in rows.exam %}
                          {% if upon.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                        {% endfor %}

                     <div style="; display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>

                     {% set prelim = [] -%}
                     {% set mid = [] -%}
                      {%- for rows in doc.table_22 -%}
                     {%- if 'Midterm' in rows.exam %}
                          {% if mid.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                     {%- if 'Prelim' in rows.exam %}
                          {% if prelim.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                        {% endfor %}

                      <div style="display: flex; width: 100%">
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Preliminary Examination </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>

                    </div>
                     <div style="display: flex; width: 100%">
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>

                    </div>


                     {% set final = [] -%}
                     {% set semi = [] -%}
                      {%- for rows in doc.table_22 -%}
                     {%- if rows.exam == 'Semi-Final' or rows.exam == 'Semi-Finals' %}
                          {% if semi.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}

                     {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                          {% if final.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                        {% endfor %}
                      <div style="display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Semi - Final </p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>
                     <div style="display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -6px">Final</p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>
                     {% set totaling = [] -%}
                      {%- for rows in doc.table_22 -%}
                          {% if totaling.append({'amounts': rows.amount}) -%}{% endif %}
                        {% endfor %}
                     <br>
                      <div style="display: flex; width: 100%">
                         <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                         <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(finalamount | round(2), precision=2)}}</p>
                     </div>
              </td>


          </table>


      <table border="0" width="100%" style="margin-top: -25px">
          <tr>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>

          </tr>

           {%- for row in doc.subjects -%}

          <tr>
            <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
            <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
              <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
            <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
            <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
            <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
            <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>

          </tr>
                    {% endfor %}

      </table>

          <div style="width: 100%; display: flex">
              <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length}}</b></p>
              <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units}}</b></p>
          </div>
      <div style="width: 100%">

          <p style="text-align: right; margin-top: 4px;"><u><b>________________________</b></u></p>
           <p style="text-align: right; margin-bottom: 4px; margin-right: 20px">Student Signature</p>
<p> - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -</p>
      </div>

  </div>
      <div >
  <table border="0" width="100%">
          <tr>

              <td width="13%">
                      <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
              </td>
              <td width="65%" align="center">
                  <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                  <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                  <p>{{doc.semester}} - {{doc.school_year}}</p>
                  <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
              </td>
              <td width="15%">
              </td>
          </tr>
      </table>

          <div style="margin-top: -10px"><b>ID Number: <u>{{doc.id_number}}</u></b></div>
          <div ><b>Student Name: <u>{{doc.student}}</u></b></div>
          <div ><b>Course:</b>{{doc.course}} - {{doc.school_year}}<u></u></div>

      <table border="0" width=100% style="margin-top: -10px">

              <td width="50%">

                  <p style="font-size: 10px"><center><b>CHARGES</b></center></p>
                   <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; font-size: 10px; margin-top: -2px">CEAP Athletic Fee</p>
                       {% set at = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'CEAP' in rows.subject  %}
                          {% if at.append({'amounts': rows.amount}) -%}


  {% endif %}
                      {% endif %}
                    {% endfor %}
                      <p style="width: 40%; text-align: right; font-size: 10px; margin-top: -2px;">
{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>

                  </div>

                  <div style="display: flex; width: 100%" >


                  <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Registration Fee</p>
                      {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Registration' in rows.subject_bill %}
                      <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>

                      {% endif %}
                        {% endfor %}
                  </div>
                  <div style="display: flex; width: 100%" >
                      {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Subject' in rows.subject_bill%}
                          {% if amounting.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
                   <p style="width: 60%; padding: 0px !important; margin-top: -2px; font-size: 10px">Tuition Fee</p>
                      {%- if doc.tuition_discount %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - doc.tuition_discount |round(2), precision=2)}}</p>

                      {%- elif doc.tuition_discount_percent %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') - (amounting|sum(attribute= 'amounts') * (doc.tuition_discount_percent / 100)) |round(2), precision=2)}}</p>

                     {%- else %}
                   <p style="width: 40%; text-align: right; padding: 0px !important; margin-top: -2px; font-size: 10px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>



                      {% endif %}

                  </div>

                  {% set misc = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if rows.subject == 'Athletic'
                              or 'Medical/Dental' in rows.subject
                              or 'Cultural' in rows.subject
                              or 'Guidance' in rows.subject
                              or 'Student' in rows.subject
                              or 'Energy' in rows.subject
                              or 'Research &' in rows.subject
                              or 'Faculty' in rows.subject
                              or 'Electronic' in rows.subject
                              or 'Library' in rows.subject
                              or 'Internet' in rows.subject
                              or 'Publication' in rows.subject
                              or 'Insurance' in rows.subject_bill
                      %}
                          {% if misc.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}

                  <div style="display: flex; width: 100%" >
                 <p style="width: 60%; margin-top: -2px; font-size: 10px">Miscellaneous Fee And Other Fees</p>
                  <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>

                  {% set labs = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {% set lab_def = frappe.get_list("Lab Fees Setup Child", filters={"subject" :rows.subject, "course": doc.course}, fields=("amount", "docstatus")) %}
                      {% for tt in lab_def %}
                          {% if labs.append({'amounts': tt.amount}) -%}{% endif %}
                      {% endfor %}

                      {%- if 'Lab' in rows.subject or 'Human' in rows.subject 
      or 'Forencis Fee' in rows.subject_bill
          or 'Forensic Fee' in rows.subject_bill%}
                          {% if 'dev' in rows.subject or 'Dev' in rows.subject %}
                          {% else %}
                          {% if labs.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                      {% endif %}
                    {% endfor %}

                  {% set labs_addi = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Lab' in rows.item_name %}
                  {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                          {% else %}
                          {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                      {% endif %}
                      {% endif %}
                    {% endfor %}
                    <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px">Laboratory Fee </p>
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(labs|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>

                  {% set lab_dev = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Lab Dev' in rows.subject or 'Lab dev' in rows.subject  or 'lab dev' in rows.subject %}
                          {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}

                  {%- for rows in doc.additional_table -%}
                      {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                                          {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                          {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                      {% endif %}
                      {% endif %}
                    {% endfor %}
                    {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                   <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px">Lab Dev't Fee </p>
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                  </div>
                  {% endif %}
                  <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Identification Card</p>
                  {% set amounting = [] -%}
                      {%- for rows in doc.tuition_table -%}
                      {%- if 'Identification' in rows.subject_bill %}
                      <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount| round(2), precision=2)}}</p>
                      {% endif %}
                        {% endfor %}
                  </div>
                     {% set old = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Previous Balance' in rows.item_name or 'OLD BALANCE' in rows.item_name or 'Old Balance' in rows.item_name %}
                                                  {%- if rows.amount|float > 0|float %}

                      {% if old.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}

                      {% endif %}
                      {% endif %}
                    {% endfor %}
<!-- <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Old Balance</p>

                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(old|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
</div> -->
{% set intern = [] -%}
{% set interns = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                      {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
                  {%- for rows in doc.tuition_table -%}
                      {%- if 'INTERNSHIP' in rows.subject or 'Internship' in rows.subject or 'internship' in rows.subject  %}
                      {% if interns.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
<div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Internship Fee</p>
                      {% if inter|len > 0 %}
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    {% else %}
                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(interns|sum(attribute= 'amounts')| round(2), precision=2)}}</p>

                          {% endif %}

<!--                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>-->
</div>
{% set book = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if rows.item_name == 'BOOK'
                              or 'BOOKS' in rows.item_name
                              or 'book' in rows.item_name
                              or 'books' in rows.item_name
                      %}
                      {% if book.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                      {% endif %}
                    {% endfor %}
<!-- <div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Books Fee</p>

                   <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(book|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
</div> -->
{%set bookfee=book|sum(attribute= 'amounts')%}
{%set addfee= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts') + old|sum(attribute= 'amounts')) %}
{%set dividefive= (book|sum(attribute= 'amounts') + intern|sum(attribute= 'amounts') + old|sum(attribute= 'amounts'))/5 %}
<div style="display: flex; width: 100%;" >
                   <p style="width: 60%; margin-top: -2px; font-size: 10px">Special Class</p>
                  {% set special = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
                      <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(rows.amount)}}</p>
                      {% endif %}
                        {% endfor %}
                  </div>

                  <div style="display: flex; width: 100%;" >
                   <!-- <p style="width: 60%; margin-top: -2px; font-size: 10px">Excess Payment Less</p> -->
                  {% set amounting = [] -%}
                  {% set excess = [] -%}
                      {%- for rows in doc.additional_table -%}
                      {%- if rows.item_name == 'Previous Balance' %}
                          {%- if rows.amount|float < 0|float %}
                          {% if excess.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
                                                  <!-- <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(excess|sum(attribute= 'amounts')| round(2), precision=2)}}</p> -->

                          {% endif %}
                      {% endif %}
                    {% endfor %}

<!--                            {%- for rows in doc.tuition_table -%}-->
<!--                            {%- if 'Excess' in rows.subject %}-->
<!--                            {% endif %}-->
<!--                              {% endfor %}-->
                  </div>
                  <div style="display: flex; width: 100%" >
                  <p style="width: 60%; margin-top: -2px; font-size: 10px"><b>TOTAL</b></p>
                  {% set finalamount = doc.final_assessment - bookfee %}
                  <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(finalamount | round(2), precision=2)}}</p>
                  </div>
                  <br>

              </td>

                 <td width="50%">
                     <p><center><b>OBLIGATION</b></center></p>

                     {% set upon = [] -%}

                      {%- for rows in doc.table_22 -%}
                           {%- if 'Upon Enrollment' in rows.exam %}
                          {% if upon.append({'amounts': rows.amount}) -%}
  {% endif %}
                      {% endif %}

                        {% endfor %}

                     <div style="; display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Upon Registration . . . </p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>
                     {% set prelim = [] -%}
                     {% set mid = [] -%}
                      {%- for rows in doc.table_22 -%}
                     {%- if 'Midterm' in rows.exam %}
                          {% if mid.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                     {%- if 'Prelim' in rows.exam %}
                          {% if prelim.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                        {% endfor %}

                    <div style="display: flex; width: 100%">
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">Preliminary Examination </p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>

                    </div>
                     <div style="display: flex; width: 100%">
                        <p style="width: 60%; margin-top: -2px; font-size: 10px">MidTerm</p>
                        <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>

                    </div>


                     {% set final = [] -%}
                     {% set semi = [] -%}
                      {%- for rows in doc.table_22 -%}
                     {%- if rows.exam == 'Semi-Final' or rows.exam == 'Semi-Finals' %}
                          {% if semi.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}

                     {%- if rows.exam == 'Finals' or rows.exam == 'Final'%}
                          {% if final.append({'amounts': rows.amount}) -%}{% endif %}
                      {% endif %}
                        {% endfor %}
                      <div style="display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -2px; font-size: 10px">Semi - Final </p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>
                     <div style="display: flex; width: 100%">
                         <p style="width: 60%; margin-top: -6px">Final</p>
                         <p style="width: 40%; margin-top: -2px; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(doc.final_assessment/5| round(2), precision=2)}}</p>
                     </div>
                      <br>

                     {% set totaling = [] -%}
                      {%- for rows in doc.table_22 -%}
                          {% if totaling.append({'amounts': rows.amount}) -%}{% endif %}
                        {% endfor %}
                     <br>
                     <div style="display: flex; width: 100%">
                         <p style="width: 60%; font-size: 10px"><b>TOTAL</b></p>
                         <p style="width: 40%; text-align: right; font-size: 10px">{{frappe.utils.fmt_money(finalamount | round(2), precision=2)}}</p>
                     </div>
              </td>


          </table>


      <table border="0" width="100%" style="margin-top: -25px">
          <tr>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>CTRL #</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>SUBJECT</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DESCRIPTION</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>UNITS</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>DAY</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>TIME</center></th>
          <th style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>ROOM</center></th>

          </tr>

           {%- for row in doc.subjects -%}

          <tr>
            <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px">{{row.idx}}</td>
            <td width="15%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"course_no")}}</td>
              <td width="30%" style="padding: 0px !important; margin: 0px !important;  font-size: 10px">{{frappe.db.get_value("Subject WC",row.subject,"subject_name")}}</td>
            <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.units}}</center></td>
            <td width="5%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.days}}</center></td>
            <td width="20%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.time_from}}-{{row.time_to}}</center></td>
            <td width="10%" style="padding: 0px !important; margin: 0px !important; font-size: 10px"><center>{{row.room}}</center></td>

          </tr>
                    {% endfor %}

      </table>

          <div style="width: 100%; display: flex">
              <p style="margin-left: 70px; margin-top: -2px">Total Subject: <b style="margin-left: 20px">{{doc.subjects|length}}</b></p>
              <p style="margin-left: 110px; margin-top: -2px">Total Units: <b style="margin-left: 20px">{{doc.total_units}}</b></p>
          </div>
      <div style="width: 100%">
          <p style="text-align: right; margin-right:150px; margin-top:4px"><b>Checked by:</b></p>
          <p style="text-align: right; margin-top: 3px"><u><b>{{ frappe.db.get_value("School WC", "School WC", "accounting_head") }}</b></u></p>
           <p style="text-align: right; margin-right: 15px">Head Accounting Office</p>
      </div>

  </div>
</div>
```
Code result from Scholarship Matriculation v2:
![[Pasted image 20250916155912.png]]

-  for ***COM for Scholar with Balance***
```
<script>
    var dt = new Date();
    document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
    </script>
    <div>
    <div >
    <table border="0" width="100%">
        <tr>

            <td width="13%">
                    <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
            </td>
            <td width="65%" align="center">
                <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                <h5><center><i><b>OFFICE OF ACCOUNTING</b></i></center></h5>
                <h5><center><i><b>oOo</b></i></center></h5>
                <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
            </td>
            <td width="15%">
            </td>
        </tr>
    </table>
        {% set lname = frappe.db.get_value("Student WC", doc.student, "last_name") %}
            {% set fname = frappe.db.get_value("Student WC", doc.student, "first_name") %}
            {% set mname = frappe.db.get_value("Student WC", doc.student, "middle_name") %}
        <table border="0" width="100%">
                <tr>
                    <td width="5%" style="margin: 0!important; padding: 0 !important"><b>Name:</b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{lname}}</td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{fname}}</td>
                    <td width="35%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{mname}}</td>
                </tr>
                <tr>
                    <td width="5%" style="margin: 0!important; padding: 0 !important"><b></b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important" align="center"><b>Surname</b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important" align="center"><b>Firstname</b></td>
                    <td width="35%" style="margin: 0!important; padding: 0 !important" align="center"><b>Middlename</b></td>
                </tr>
            </table>
        <div style="width: 100%">
                    <p  class="col-xs-1" style="margin: 0!important; padding: 0 !important"><b>Course:</b></p>
                    <p  class="col-xs-7" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{doc.course}}</p>
                 <p  class="col-xs-1"></p>
                    <p class="col-xs-1" align="center"><b>Level:</b></p>
                    <p  class="col-xs-2" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{doc.year_level}}</p>
            </div>
        <br>
        <br>
        <center><h4 class="col-xs-12" style="margin: 0 !important"><b><i>{{doc.semester}}</i></b></h4></center>
        <center><p style="font-size: 10px; margin: 0 !important"><b>{{doc.school_year}}</b></p></center>

        <br>
        {% set at = [] -%}
        {% set reg = [] -%}
        {% set amounting = [] -%}
        {% set misc = [] -%}
        {% set labs = [] -%}
        {% set criminalistic_fee = [] -%}
        {% set human_kinetics_fee = [] -%}
        {% set forensic_fee = [] -%}
        {% set lab_dev = [] -%}
        {% set id_fee = [] %}
        {% set intern = [] -%}
        {% set final_ass = [] %}
        {% set totalTuition = {'amount': 0.0} %}


        {%- for rows in doc.tuition_table -%}
            {% if final_ass.append({'amounts': rows.amount|float}) -%}{% endif %}
            {%- if 'CEAP' in rows.subject_bill  %}
                    {% if at.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                    {% if at.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Registration' in rows.subject_bill %}
                {% if reg.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                {% if reg.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Subject' in rows.subject_bill%}
                {% if amounting.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if amounting.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {% set item_group = frappe.get_doc("Item",rows.subject).item_group %}

            {% if "Miscellaneous" in item_group %}
                {% if misc.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if misc.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
<!--                HUMAN KINETICS FEE-->
            {%- if 'human' in item_group.lower() -%}
            {% if human_kinetics_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if human_kinetics_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            <!--                FORENSIC FEE-->
            {%- if 'forensic' in item_group.lower() -%}
            {% if forensic_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if forensic_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            <!--                CRIMINALISTIC FEE-->
            {%- if 'criminalistic' in item_group.lower() -%}
            {% if criminalistic_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if criminalistic_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            {% if 'laboratory' in item_group.lower() %}
                {% if labs.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if labs.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
                {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                {% if lab_dev.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Identification' in rows.subject_bill %}
                {% if id_fee.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% else %}
                {% if id_fee.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
                {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if intern.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

        {% endfor %}
        {% set labs_addi = [] -%}
        {% set old_balance = [] -%}
        {% set special_class = [] -%}
        {% set prev_bal = [] -%}
        {% set excess_fee = [] -%}
        {% set grad_fee = [] -%}

        {%- for rows in doc.additional_table -%}
            {%- if 'Lab' in rows.item_name %}
                {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                {% else %}
                    {% if rows.amount %}
                        {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                    {% else %}
                        {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                    {% endif %}
                {% endif %}
            {% endif %}
            {% endfor %}

        {% set special = [] -%}
        {%- for rows in doc.additional_table -%}
            {% if final_ass.append({'amounts': rows.amount|float}) -%}{% endif %}
            {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                    {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% else %}
                    {% if lab_dev.append({'amounts': 0}) -%}{% endif %}
                {% endif %}
            {% endif %}


            {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if intern.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
               {% if special.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
               {% if special.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'PREVIOUS BALANCE' in rows.item_name or 'Previous Balance' in rows.item_name or 'previous balance' in rows.item_name  %}
                {% if prev_bal.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if prev_bal.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'GRADUATION FEE' in rows.item_name or 'Graduation Fee' in rows.item_name or 'graduation fee' in rows.item_name  %}
                {% if grad_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if grad_fee.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}
        {% endfor %}
        

        {% set prev_balance = {'amount': 0.0} %}
        {%- for rows in doc.additional_table -%}
            {% if "Previous Balance" in rows.item_name %}
                    {% if prev_balance.update({'amount': prev_balance['amount']|float + rows.amount|float}) %}
                    {% endif %}
            {% endif %}

        {% endfor %}
        {% set criminalistic = criminalistic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
        {% set forensic = forensic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
        {% set human = human_kinetics_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
 
        <table border="0" width=100%">
            <tr>
                <td width="100%">
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%; font-size: 12px;">CEAP Athletic Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px;">{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>
                    </div>
                    <div style="display: flex; width: 100%">
                        <p style="width: 20%; padding: 0px !important; font-size: 12px">Registration Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; padding: 0px !important;  font-size: 12px">{{frappe.utils.fmt_money(reg|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                         <p style="width: 20%; padding: 0px !important; font-size: 12px">Tuition Fee</p>
                         <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                         <p style="width: 15%; text-align: right; padding: 0px !important;  font-size: 12px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                        <p style="width: 35%;  font-size: 12px">Miscellaneous Fee And Other Fees</p>
                        <p style="width: 60%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%;  font-size: 12px">Graduation Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(grad_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%; font-size: 12px">Laboratory Fee </p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(labs|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                    {% if criminalistic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Criminalistic Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(criminalistic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if forensic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Forensic Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(forensic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if human != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Human Kinetics Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(human, precision=2)}}</p>
                    </div>
                    {% endif %}

                     <div style="display: flex; width: 100%" >
                        <p style="width: 20%;  font-size: 12px">Lab Dev't Fee </p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%; font-size: 12px">Identification Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(id_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%;  font-size: 12px">Internship Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">
                            {{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%;  font-size: 12px">Special Class</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(special|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%;  font-size: 12px">Previous Balance</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(prev_bal|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%; font-size: 12px"><b>TOTAL</b></p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px; border-bottom: double;"><b>
                            {{frappe.utils.fmt_money(final_ass|sum(attribute= 'amounts')| round(2), precision=2)}}
                        </b></p>
                    </div>
                    <br>
                </td>
            </tr>
        </table>
    <table width="100%">
            <tr>
                <td width="50%">
                    <p><b><i>Prepared by:</i></b></p>
                    <br>

            <p style="text-align: center; margin-top: 4px;"><u>{{frappe.db.get_value('User', frappe.user, "full_name") | upper}}</u></p>
             <p style="text-align: center; margin-bottom: 4px;">Ledger Clerk</p>
                </td>
                <td width="50%">

                </td>
            </tr>

        </table>
        <br>
         <table width="100%">

            <tr>
                <td width="50%">

                </td>
                <td width="50%">
                    <p><b><i>Checked by:</i></b></p>
                    <br>

            <p style="text-align: center; margin-top: 4px;"><u>{{ frappe.db.get_value("School WC", "School WC", "accounting_head" )}}</u></p>
             <p style="text-align: center; margin-bottom: 4px;">Head, Accounting Office</p>
                </td>

            </tr>

        </table>
    <br>
    <p style="margin-left: 90px">Not Valid w/o</p>
    <p style="margin-left: 90px">School Seal</p>
    </div>
    </div>
```
Code result from COM for Scholar with Balance v2:
![[Pasted image 20250916160051.png]]
![[Pasted image 20250916160118.png]]

-  for ***COM for Scholar***
```
<script>
    var dt = new Date();
    document.getElementById("datetime").innerHTML = dt.toLocaleDateString();
    </script>
    <div>
    <div >
    <table border="0" width="100%">
        <tr>

            <td width="13%">
                    <img src={{frappe.db.get_value("School WC","School WC","school_logo")}} style="width: 110%;">
            </td>
            <td width="65%" align="center">
                <font size="3" face="Times New Roman"><b>{{frappe.db.get_value("School WC","School WC","school_name")}}</font><br>
                <font size="1">{{frappe.db.get_value("School WC","School WC","school_address")}}</font><br>
                <h5><center><i><b>OFFICE OF ACCOUNTING</b></i></center></h5>
                <h5><center><i><b>oOo</b></i></center></h5>
                <h5><center><b>CERTIFICATION OF MATRICULATION</b></center></h5>
            </td>
            <td width="15%">
            </td>
        </tr>
    </table>
        {% set lname = frappe.db.get_value("Student WC", doc.student, "last_name") %}
            {% set fname = frappe.db.get_value("Student WC", doc.student, "first_name") %}
            {% set mname = frappe.db.get_value("Student WC", doc.student, "middle_name") %}
        <table border="0" width="100%">
                <tr>
                    <td width="5%" style="margin: 0!important; padding: 0 !important"><b>Name:</b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{lname}}</td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{fname}}</td>
                    <td width="35%" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{mname}}</td>
                </tr>
                <tr>
                    <td width="5%" style="margin: 0!important; padding: 0 !important"><b></b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important" align="center"><b>Surname</b></td>
                    <td width="30%" style="margin: 0!important; padding: 0 !important" align="center"><b>Firstname</b></td>
                    <td width="35%" style="margin: 0!important; padding: 0 !important" align="center"><b>Middlename</b></td>
                </tr>
            </table>
        <div style="width: 100%">
                    <p  class="col-xs-1" style="margin: 0!important; padding: 0 !important"><b>Course:</b></p>
                    <p  class="col-xs-7" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{doc.course}}</p>
                 <p  class="col-xs-1"></p>
                    <p class="col-xs-1" align="center"><b>Level:</b></p>
                    <p  class="col-xs-2" style="margin: 0!important; padding: 0 !important; border-bottom: 1px solid black" align="center">{{doc.year_level}}</p>
            </div>
        <br>
        <br>
        <center><h4 class="col-xs-12" style="margin: 0 !important"><b><i>{{doc.semester}}</i></b></h4></center>
        <center><p style="font-size: 10px; margin: 0 !important"><b>{{doc.school_year}}</b></p></center>

        <br>
        {% set at = [] -%}
        {% set reg = [] -%}
        {% set amounting = [] -%}
        {% set misc = [] -%}
        {% set labs = [] -%}
        {% set criminalistic_fee = [] -%}
        {% set human_kinetics_fee = [] -%}
        {% set forensic_fee = [] -%}
        {% set lab_dev = [] -%}
        {% set laboratory_fee = [] -%}
        {% set id_fee = [] %}
        {% set intern = [] -%}
        {% set final_ass = [] %}
        {% set totalTuition = {'amount': 0.0} %}


        {%- for rows in doc.tuition_table -%}
            {% if final_ass.append({'amounts': rows.amount|float}) -%}{% endif %}
            {%- if 'CEAP' in rows.subject_bill  %}
                    {% if at.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                    {% if at.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Registration' in rows.subject_bill %}
                {% if reg.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                {% if reg.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Subject' in rows.subject_bill%}
                {% if amounting.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if amounting.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {% set item_group = frappe.get_doc("Item",rows.subject).item_group %}

            {% if "Miscellaneous" in item_group %}
                {% if misc.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if misc.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
<!--                HUMAN KINETICS FEE-->
            {%- if 'human' in item_group.lower() -%}
            {% if human_kinetics_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if human_kinetics_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            <!--                FORENSIC FEE-->
            {%- if 'forensic' in item_group.lower() -%}
            {% if forensic_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if forensic_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            <!--                CRIMINALISTIC FEE-->
            {%- if 'criminalistic' in item_group.lower() -%}
            {% if criminalistic_fee.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
            {% if criminalistic_fee.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
            {% if "Laboratory" in item_group %}
                {% if labs.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                 {% if labs.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Lab Dev' in rows.subject_bill or 'Lab dev' in rows.subject_bill  or 'lab dev' in rows.subject_bill %}
                {% if lab_dev.append({'amounts': rows.amount}) -%}{% endif %}
            {% else %}
                {% if lab_dev.append({'amounts': 0}) -%}{% endif %}
            {% endif %}

            {%- if 'Identification' in rows.subject_bill %}
                {% if id_fee.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% else %}
                {% if id_fee.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'Lab Fee' in rows.subject_bill %}
                {% if laboratory_fee.append({'amounts': rows.amount|float}) -%}{% endif %}
            {% else %}
                {% if laboratory_fee.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'INTERNSHIP' in rows.subject_bill or 'Internship' in rows.subject_bill or 'internship' in rows.subject_bill  %}
                {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if intern.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

        {% endfor %}
        {% set labs_addi = [] -%}
        {% set old_balance = [] -%}
        {% set special_class = [] -%}
        {% set excess_fee = [] -%}
        {% set grad_fee = [] -%}

        {%- for rows in doc.additional_table -%}
            {%- if 'Lab' in rows.item_name %}
                {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                {% else %}
                    {% if rows.amount %}
                        {% if labs_addi.append({'amounts': rows.amount|float}) -%}{% endif %}
                    {% else %}
                        {% if labs_addi.append({'amounts': 0|float}) -%}{% endif %}
                    {% endif %}
                {% endif %}
            {% endif %}
            {% endfor %}

        {% set special = [] -%}
        {%- for rows in doc.additional_table -%}
            {% if final_ass.append({'amounts': rows.amount|float}) -%}{% endif %}
            {%- if 'Lab Dev' in rows.item_name or 'Lab dev' in rows.item_name  or 'lab dev' in rows.item_name %}
                {% if 'dev' in rows.item_name or 'Dev' in rows.item_name %}
                    {% if lab_dev.append({'amounts': rows.amount|float}) -%}{% endif %}
                {% else %}
                    {% if lab_dev.append({'amounts': 0}) -%}{% endif %}
                {% endif %}
            {% endif %}

            {%- if 'INTERNSHIP' in rows.item_name or 'Internship' in rows.item_name or 'internship' in rows.item_name  %}
                {% if intern.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if intern.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

            {%- if 'Special' in rows.item_name or 'SPECIAL' in rows.item_name %}
               {% if special.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
               {% if special.append({'amounts': 0}) -%}{% endif %}
            {% endif %}
        {% endfor %}

        {% set prev_balance = {'amount': 0.0} %}
        {%- for rows in doc.additional_table -%}
            {% if "Previous Balance" in rows.item_name %}
                    {% if prev_balance.update({'amount': prev_balance['amount']|float + rows.amount|float}) %}
                    {% endif %}
            {% endif %}

            {%- if 'GRADUATION FEE' in rows.item_name or 'Graduation Fee' in rows.item_name or 'graduation fee' in rows.item_name  %}
                {% if grad_fee.append({'amounts': rows.amount|float (0.5)}) -%}{% endif %}
            {% else %}
                {% if grad_fee.append({'amounts': 0|float}) -%}{% endif %}
            {% endif %}

        {% endfor %}
        {% set criminalistic = criminalistic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
        {% set forensic = forensic_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
        {% set human = human_kinetics_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2) -%}
 
        <table border="0" width=100%">
            <tr>
                <td width="100%">
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%; font-size: 12px;">CEAP Athletic Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px;">{{frappe.utils.fmt_money(at|sum(attribute= 'amounts')|round(2), precision=2)}} </p>
                    </div>
                    <div style="display: flex; width: 100%">
                        <p style="width: 20%; padding: 0px !important; font-size: 12px">Registration Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; padding: 0px !important;  font-size: 12px">{{frappe.utils.fmt_money(reg|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                         <p style="width: 20%; padding: 0px !important; font-size: 12px">Tuition Fee</p>
                         <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                         <p style="width: 15%; text-align: right; padding: 0px !important;  font-size: 12px">{{frappe.utils.fmt_money(amounting|sum(attribute= 'amounts') |round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%" >
                        <p style="width: 35%;  font-size: 12px">Miscellaneous Fee And Other Fees</p>
                        <p style="width: 60%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(misc|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%;  font-size: 12px">Graduation Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(grad_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%; font-size: 12px">Laboratory Fee </p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(laboratory_fee|sum(attribute= 'amounts') + labs_addi|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% if doc.course == "BSCRIM - BACHELOR OF SCIENCE IN CRIMINOLOGY" %}
                    {% if criminalistic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Criminalistic Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(criminalistic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if forensic != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Forensic Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(forensic, precision=2)}}</p>
                    </div>
                    {% endif %}
                    {% if human != 0 %}
                    <div style="display: flex; width: 100%" >
                    <p  style="width: 20%; font-size: 12px">Human Kinetics Fee </p>
                    <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                    <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(human, precision=2)}}</p>
                    </div>
                    {% endif %}

                     <div style="display: flex; width: 100%" >
                        <p style="width: 20%;  font-size: 12px">Lab Dev't Fee </p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(lab_dev|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    {% endif %}
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%; font-size: 12px">Identification Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%;  text-align: right; font-size: 12px">{{frappe.utils.fmt_money(id_fee|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%;  font-size: 12px">Internship Fee</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">
                            {{frappe.utils.fmt_money(intern|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    <div style="display: flex; width: 100%;" >
                        <p style="width: 20%;  font-size: 12px">Special Class</p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px">{{frappe.utils.fmt_money(special|sum(attribute= 'amounts')| round(2), precision=2)}}</p>
                    </div>
                    

                    <div style="display: flex; width: 100%" >
                        <p style="width: 20%; font-size: 12px"><b>TOTAL</b></p>
                        <p style="width: 75%; border-bottom: 1px dotted black; margin-top: -2px"></p>
                        <p style="width: 15%; text-align: right; font-size: 12px; border-bottom: double;"><b>
                            {{frappe.utils.fmt_money(final_ass|sum(attribute= 'amounts')| round(2) - prev_balance['amount'] |round(2), precision=2)}}  
                        </b></p>
                    </div>
                    <br>
                </td>
            </tr>
        </table>
    <table width="100%">
            <tr>
                <td width="50%">
                    <p><b><i>Prepared by:</i></b></p>
                    <br>

            <p style="text-align: center; margin-top: 4px;"><u>{{frappe.db.get_value('User', frappe.user, "full_name") | upper}}</u></p>
             <p style="text-align: center; margin-bottom: 4px;">Ledger Clerk</p>
                </td>
                <td width="50%">

                </td>
            </tr>

        </table>
        <br>
         <table width="100%">

            <tr>
                <td width="50%">

                </td>
                <td width="50%">
                    <p><b><i>Checked by:</i></b></p>
                    <br>

            <p style="text-align: center; margin-top: 4px;"><u>{{ frappe.db.get_value("School WC", "School WC", "accounting_head" )}}</u></p>
             <p style="text-align: center; margin-bottom: 4px;">Head, Accounting Office</p>
                </td>

            </tr>

        </table>
    <br>
    <p style="margin-left: 90px">Not Valid w/o</p>
    <p style="margin-left: 90px">School Seal</p>
    </div>
    </div>
```
Code result from COM for Scholar v2:
![[Pasted image 20250916160209.png]]